# GitHubApp
Swift6対応、SwiftUI、マルチモジュール、ViewModelを使わないアーキテクチャなど、トレンドを重視したアプリです。

@Metadata {
    @CallToAction(url: "https://github.com/mareiirie/GithubApp", purpose: link)
}

## 動作確認時の注意
起動時、ログインを求められますが、Mockなので、認証などは一切しておらず、何を入れても大丈夫です。
ただし、ログイン後に表示できるProfileViewでは、この時入力した文字列を、GitHubAPIの[Get a User API](https://docs.github.com/ja/rest/users/users?apiVersion=2022-11-28#get-a-user)のパラメーターに設定しているため、存在しないユーザー名の場合はProfileViewで404(Resource not found)のエラーが表示されます。
存在するユーザー名でログインすると、そのユーザーの情報が表示されます。
私のGitHubユーザー名(`MareiIrie`)でログインしていただいても大丈夫です。

## 画面構成について
![A diagram](Structure.png)

## アーキテクチャについて
SplashViewについてはViewModelを作成。その他の画面は、データのドメインごとに作成されたStoreとバインドさせており、ViewModelは作成していない。

MVVMというと基本的には1画面1ViewModelだが、SwiftUIでは、取りたいデータのドメインカテゴリごとのStoreが存在し、そのStoreとデータバインドさせた方がシンプルなアーキテクチャになるのではと考えている。
また、他の画面に共有したいStoreはEnvironmentObject、画面の破棄とともに破棄したいStoreはStateObjectにすることで、Storeの生存スコープも柔軟に管理することができる。

## テストについて
ViewModel・Storeどちらも同じようにテストが可能。
工夫している点は、APIClientの関数を関数型の値にすることで、使用したい関数だけ上書きする形でInjectionできることである。
よくある手法はAPIClientをProtocolにしてDIするという手法だが、これは以下の2つのデメリットがある。
- 本番用のコードにまでDIするためだけのボイラープレートが増える。
- protocolなので、テスト時に必要ないAPIの関数まで全てインジェクションしなければいけない。

APIClientの関数を関数型の値にすると、テスト時には関数化された値を上書きするだけなので、上記2つのデメリットを解決する。

## マルチモジュールについて
Featureやデータレイヤーなどをモジュール化することで、以下のメリットがある。
- Previewビルドが高速に
  - Previewビルドしたいだけなのにソースコード全体をビルドする必要はないはず
- Testも高速に
  - Preview同様、関係するコードのビルドだけでテストできる
- ミニアプリを作れる
  - 確認したい画面と、その画面に依存するモジュールだけLinkさせたアプリを本体とは別のTargetで用意する。確認したい画面関連のビルドだけ行われるので、ビルドが爆速になる。UITestもこのアプリを活用すれば簡単になる（いらない遷移をスキップし、確認したい画面だけに集中できる・本体コードを汚さなくて済む）
- 疎結合を強制
  - 依存関係をなるべく綺麗に保つために、クリーンアーキテクチャを意識するように矯正される

# Swift6対応について
 Swift6で標準となるStrict Concurrency Checkingへの対応済みのため、チェックレベルを最大にしてもワーニングは0件。 今回実装したクラスはほとんどがViewとバインドするクラスであるため、メインアクター隔離を行うことでSendableにした。

 # 今回注力していないもの
 - レイアウト
   - 細かくやろうと思えばいくらでもできてしまう
 - 全てのテストケースは書いていない
   - これが書けるなら他のも書けるのは自明、という前提で最小限のテストを書いた
 - ソートなどのクエリやページネーション
   - やろうと思えばいくらでもできてしまうので、省略。
